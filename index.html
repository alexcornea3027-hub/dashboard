<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PI Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Chart.js -->

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --bg: #0f172a;
      --card: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent1: #38bdf8;
      --accent2: #22c55e;
      --accent3: #f97316;
    }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, #1e293b, #020617);
      color: var(--text);
    }

    header {
      padding: 24px;
      font-size: 28px;
      font-weight: 700;
      letter-spacing: 0.3px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      padding: 20px;
    }

    .card {
      background: linear-gradient(145deg, #020617, #020617);
      border-radius: 18px;
      padding: 20px;
      box-shadow:
        0 30px 60px rgba(0, 0, 0, 0.6),
        inset 0 1px 0 rgba(255, 255, 255, 0.04);
      transform: translateY(0);
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }

    .card:hover {
      transform: translateY(-6px);
      box-shadow: 0 40px 80px rgba(0, 0, 0, 0.8);
    }

    h3 {
      margin: 0 0 12px 0;
      font-size: 18px;
      font-weight: 600;
      color: var(--muted);
    }

    canvas {
      max-height: 260px;
    }

    .kpi {
      font-size: 44px;
      font-weight: 700;
      color: var(--accent1);
      text-align: center;
      margin-top: 30px;
    }

    .sub {
      text-align: center;
      color: var(--muted);
      font-size: 14px;
    }
  </style>

</head>
<body>

<header>PI Operational Dashboard</header>

<div class="grid">
  <div class="card">
    <h3>Daily PI — Counted vs Remaining</h3>
    <canvas id="dailyDonut"></canvas>
    <div class="kpi" id="dailyTotal"></div>
    <div class="sub">Target: 1,193 locations</div>
  </div>

  <div class="card">
    <h3>Weekly PI — Counted vs Remaining</h3>
    <canvas id="weeklyDonut"></canvas>
    <div class="kpi" id="weeklyTotal"></div>
    <div class="sub">Weekly progress</div>
  </div>

  <div class="card">
    <h3>Weekly PI — Series by Area</h3>
    <canvas id="weeklyBar"></canvas>
  </div>
</div>

<script>
/* =========================
   EMBEDDED DATA (NO FETCH)
   ========================= */
const DATA = " + JSON.stringify({"piData":[],"dailyTask":[],"weeklyTask":[],"weeklyPiData":[]}) + ";

/* =========================
   LOGIC
   ========================= */
var TARGET_DAILY = 1193;

function sum(arr, key) {
  var t = 0;
  for (var i = 0; i < arr.length; i++) t += Number(arr[i][key] || 0);
  return t;
}

// DAILY TOTAL
var dailyTotal = sum(DATA.weeklyPiData, 'Daily Qty');
var dailyRemaining = Math.max(TARGET_DAILY - dailyTotal, 0);

document.getElementById('dailyTotal').innerText = dailyTotal;

new Chart(document.getElementById('dailyDonut'), {
  type: 'doughnut',
  data: {
    labels: ['Counted', 'Remaining'],
    datasets: [{
      data: [dailyTotal, dailyRemaining],
      backgroundColor: ['#38bdf8', '#1e293b'],
      borderWidth: 0
    }]
  },
  options: {
    cutout: '70%',
    plugins: { legend: { position: 'bottom', labels: { color: '#9ca3af' } } }
  }
});

// WEEKLY TOTAL
var weeklyTotal = sum(DATA.weeklyPiData, 'Weekly Qty');
document.getElementById('weeklyTotal').innerText = weeklyTotal;

new Chart(document.getElementById('weeklyDonut'), {
  type: 'doughnut',
  data: {
    labels: ['Weekly Counted'],
    datasets: [{
      data: [weeklyTotal],
      backgroundColor: ['#22c55e'],
      borderWidth: 0
    }]
  },
  options: {
    cutout: '70%',
    plugins: { legend: { display: false } }
  }
});

// WEEKLY SERIES BY AREA
var areas = [];
var weeklySeries = [];
for (var i = 0; i < DATA.weeklyPiData.length; i++) {
  areas.push(DATA.weeklyPiData[i].Area);
  weeklySeries.push(DATA.weeklyPiData[i]['Weekly Qty']);
}

new Chart(document.getElementById('weeklyBar'), {
  type: 'bar',
  data: {
    labels: areas,
    datasets: [{
      label: 'Weekly Qty',
      data: weeklySeries,
      backgroundColor: '#f97316'
    }]
  },
  options: {
    plugins: { legend: { labels: { color: '#9ca3af' } } },
    scales: {
      x: { ticks: { color: '#9ca3af' } },
      y: { ticks: { color: '#9ca3af' } }
    }
  }
}); " + JSON.stringify({

