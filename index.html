<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VCB Stock Intelligence | Executive 3D</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');

        :root {
            --bg: #020617;
            --glass: rgba(15, 23, 42, 0.8);
            --border: rgba(255, 255, 255, 0.1);
            --cyan: #22d3ee;
            --emerald: #10b981;
            --rose: #f43f5e;
            --amber: #fbbf24;
            --shadow-3d: 0 20px 25px -5px rgba(0, 0, 0, 0.5), 0 10px 10px -5px rgba(0, 0, 0, 0.4);
            --neon-glow: 0 0 15px rgba(34, 211, 238, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: radial-gradient(circle at 0% 0%, #0f172a 0%, #020617 100%);
            color: #f8fafc;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            padding: 15px;
        }

        /* FULLSCREEN BUTTON */
        #fs-toggle {
            position: fixed; top: 15px; right: 20px; z-index: 1000;
            background: var(--glass); border: 1px solid var(--cyan);
            color: var(--cyan); padding: 8px 15px; border-radius: 12px;
            font-weight: 800; cursor: pointer; backdrop-filter: blur(10px);
            box-shadow: var(--neon-glow); transition: 0.3s;
        }
        #fs-toggle:hover { background: var(--cyan); color: white; transform: translateY(-2px); }

        /* HEADER SECTION */
        header {
            height: 12vh;
            display: grid; grid-template-columns: 1.2fr 2fr 1.2fr;
            gap: 15px; margin-bottom: 15px;
        }

        .h-panel {
            background: var(--glass); backdrop-filter: blur(20px);
            border: 1px solid var(--border); border-radius: 20px;
            padding: 10px 25px; box-shadow: var(--shadow-3d);
            display: flex; align-items: center; justify-content: space-between;
        }

        .kpi-unit { text-align: center; }
        .kpi-unit span { font-size: 0.65rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; }
        .kpi-unit h2 { font-size: 1.8rem; font-weight: 800; color: var(--cyan); text-shadow: var(--neon-glow); }

        /* MAIN GRID */
        main {
            flex: 1;
            display: grid;
            grid-template-columns: 1.3fr 1fr 1fr;
            grid-template-rows: repeat(2, 1fr);
            gap: 15px;
            min-height: 0; /* Important pentru flex-scroll */
        }

        .card {
            background: var(--glass); backdrop-filter: blur(15px);
            border: 1px solid var(--border); border-radius: 24px;
            padding: 15px; display: flex; flex-direction: column;
            box-shadow: var(--shadow-3d); position: relative;
        }

        .card::after { /* Efect de sticla 3D lateral */
            content: ''; position: absolute; inset: 0; border-radius: 24px;
            background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, transparent 100%);
            pointer-events: none;
        }

        .card-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 15px;
        }

        .card-header h3 { font-size: 0.75rem; font-weight: 800; text-transform: uppercase; color: var(--cyan); letter-spacing: 1px; }

        .chart-container { flex: 1; min-height: 0; position: relative; width: 100%; }

        /* DOUGHNUT CENTER TEXT */
        .chart-overlay {
            position: absolute; top: 55%; left: 50%;
            transform: translate(-50%, -50%); text-align: center;
        }
        .chart-overlay h4 { font-size: 1.6rem; font-weight: 800; color: white; }
        .chart-overlay p { font-size: 0.6rem; color: #94a3b8; }

        /* TASK LIST */
        .scroller { overflow-y: auto; padding-right: 5px; }
        .scroller::-webkit-scrollbar { width: 4px; }
        .scroller::-webkit-scrollbar-thumb { background: var(--cyan); border-radius: 10px; }

        .task-row {
            background: rgba(255,255,255,0.03); margin-bottom: 6px;
            padding: 10px 15px; border-radius: 12px;
            display: flex; justify-content: space-between; align-items: center;
            border-left: 4px solid var(--border); transition: 0.2s;
        }
        .task-row.done { border-left-color: var(--emerald); background: rgba(16, 185, 129, 0.05); }
        .task-name { font-size: 0.8rem; font-weight: 600; }
        .task-status { font-size: 0.65rem; font-weight: 800; color: #64748b; }

        /* RESPONSIVE FIX FOR SMALLER SCREENS */
        @media (max-height: 800px) {
            .kpi-unit h2 { font-size: 1.4rem; }
            .card { padding: 10px; }
        }
    </style>
</head>
<body>

    <button id="fs-toggle" onclick="toggleFullScreen()">ACTIVATE FULLSCREEN</button>

    <header>
        <div class="h-panel">
            <div>
                <h2 id="live-clock" style="font-size: 1.6rem;">00:00:00</h2>
                <p id="live-date" style="font-size: 0.8rem; color: var(--cyan); font-weight: 600;"></p>
            </div>
        </div>
        <div class="h-panel">
            <div class="kpi-unit"><span>Realized Today</span><h2 id="total-day">0</h2></div>
            <div class="kpi-unit"><span>Avg/Area</span><h2 id="avg-area">0</h2></div>
            <div class="kpi-unit"><span>Target Variance</span><h2 id="delta-target">0</h2></div>
        </div>
        <div class="h-panel" style="border-right: 5px solid var(--emerald);">
            <div style="text-align: right; width: 100%;">
                <span>Compliance Score</span>
                <h2 id="compliance-total" style="color: var(--emerald);">0%</h2>
            </div>
        </div>
    </header>

    <main>
        <div class="card">
            <div class="card-header"><h3>Daily Output by Area</h3><span>Live</span></div>
            <div class="chart-container"><canvas id="dailyBar"></canvas></div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Daily Tasks</h3><span>Internal</span></div>
            <div class="chart-container">
                <canvas id="dailyDonut"></canvas>
                <div class="chart-overlay"><h4 id="d-label">0%</h4><p>COMPLETED</p></div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Weekly Tasks</h3><span>Global</span></div>
            <div class="chart-container">
                <canvas id="weeklyDonut"></canvas>
                <div class="chart-overlay"><h4 id="w-label">0%</h4><p>COMPLETED</p></div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Weekly Distribution</h3><span id="current-week-no">Week --</span></div>
            <div class="chart-container"><canvas id="weeklyDistBar"></canvas></div>
        </div>

        <div class="card">
            <div class="card-header"><h3>Volume Progression</h3><span>By Week</span></div>
            <div class="chart-container"><canvas id="progressionLine"></canvas></div>
        </div>

        <div class="card">
            <div class="card-header"><h3>System Monitor</h3><span>Priority List</span></div>
            <div class="scroller" id="task-feed">
                </div>
        </div>
    </main>

    <script>
        // DATE REALE BAZATE PE CERINTA TA
        const dashboardData = {
            "stats": [
                {"area": "MPR", "day": 127, "week": 34, "total": 5103},
                {"area": "PB1", "day": 38, "week": 34, "total": 6457},
                {"area": "PB2", "day": 15, "week": 34, "total": 7494},
                {"area": "PB3", "day": 42, "week": 33, "total": 6901},
                {"area": "MP", "day": 221, "week": 34, "total": 2068},
                {"area": "MIX", "day": 136, "week": 32, "total": 1200},
                {"area": "MS", "day": 61, "week": 34, "total": 450}
            ],
            "dailyTasks": [
                {"name": "Aged stock 7AM", "done": true},
                {"name": "ADJUSTMENTS", "done": false},
                {"name": "LOCATIONS ERROR", "done": false},
                {"name": "SLA UPDATE", "done": false},
                {"name": "PI 1st Count", "done": false}
            ],
            "weeklyTasks": [
                {"name": "Shrinkage Period", "done": true},
                {"name": "SIS Report", "done": false},
                {"name": "Weekly SLA", "done": false}
            ]
        };

        function toggleFullScreen() {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        }

        function initClock() {
            const update = () => {
                const now = new Date();
                document.getElementById('live-clock').innerText = now.toLocaleTimeString('en-GB');
                document.getElementById('live-date').innerText = now.toLocaleDateString('en-GB', { weekday:'long', day:'numeric', month:'short' });
            };
            setInterval(update, 1000); update();
        }

        function renderCharts() {
            const ctxOptions = {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { 
                    y: { display: false }, 
                    x: { ticks: { color: '#94a3b8', font: { size: 10 } }, grid: { display: false } } 
                }
            };

            // 1. Daily Bar Chart
            new Chart(document.getElementById('dailyBar'), {
                type: 'bar',
                data: {
                    labels: dashboardData.stats.map(s => s.area),
                    datasets: [{
                        data: dashboardData.stats.map(s => s.day),
                        backgroundColor: '#22d3ee', borderRadius: 8, barThickness: 20
                    }]
                },
                options: ctxOptions
            });

            // 2. Weekly Distribution (Only latest week)
            const maxW = Math.max(...dashboardData.stats.map(s => s.week));
            document.getElementById('current-week-no').innerText = `Week ${maxW}`;
            const latestData = dashboardData.stats.filter(s => s.week === maxW);
            
            new Chart(document.getElementById('weeklyDistBar'), {
                type: 'bar',
                data: {
                    labels: latestData.map(s => s.area),
                    datasets: [{
                        data: latestData.map(s => s.total),
                        backgroundColor: '#10b981', borderRadius: 8, barThickness: 20
                    }]
                },
                options: ctxOptions
            });

            // 3. Volume Progression
            const weeks = [...new Set(dashboardData.stats.map(s => s.week))].sort();
            const weekTotals = weeks.map(w => 
                dashboardData.stats.filter(s => s.week === w).reduce((acc, curr) => acc + curr.total, 0)
            );

            new Chart(document.getElementById('progressionLine'), {
                type: 'line',
                data: {
                    labels: weeks.map(w => "W" + w),
                    datasets: [{
                        data: weekTotals,
                        borderColor: '#22d3ee', tension: 0.4, fill: true,
                        backgroundColor: 'rgba(34, 211, 238, 0.1)', pointRadius: 5
                    }]
                },
                options: ctxOptions
            });

            // 4. Donuts
            const dScore = renderDonut('dailyDonut', 'd-label', dashboardData.dailyTasks, '#22d3ee');
            const wScore = renderDonut('weeklyDonut', 'w-label', dashboardData.weeklyTasks, '#10b981');
            document.getElementById('compliance-total').innerText = Math.round((dScore + wScore) / 2) + "%";

            // KPI Header logic
            const dayTotal = dashboardData.stats.reduce((a, b) => a + b.day, 0);
            document.getElementById('total-day').innerText = dayTotal;
            document.getElementById('avg-area').innerText = Math.round(dayTotal / dashboardData.stats.length);
            const delta = dayTotal - 1193;
            document.getElementById('delta-target').innerText = (delta > 0 ? "+" : "") + delta;
            document.getElementById('delta-target').style.color = delta >= 0 ? 'var(--emerald)' : 'var(--rose)';

            // Task Feed
            const feed = document.getElementById('task-feed');
            [...dashboardData.dailyTasks, ...dashboardData.weeklyTasks].forEach(t => {
                feed.innerHTML += `
                    <div class="task-row ${t.done ? 'done' : ''}">
                        <span class="task-name">${t.name}</span>
                        <span class="task-status">${t.done ? 'âœ” DONE' : 'WAITING'}</span>
                    </div>
                `;
            });
        }

        function renderDonut(id, labelId, tasks, color) {
            const done = tasks.filter(t => t.done).length;
            const perc = Math.round((done / tasks.length) * 100);
            document.getElementById(labelId).innerText = perc + "%";
            
            new Chart(document.getElementById(id), {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [done, tasks.length - done],
                        backgroundColor: [color, 'rgba(255,255,255,0.05)'],
                        borderWidth: 0, cutout: '80%'
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { tooltip: { enabled: false } } }
            });
            return perc;
        }

        initClock();
        renderCharts();
    </script>
</body>
</html>
