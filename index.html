<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>VCB StockTeam Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {
  --bg: #fff7ed;
  --card: rgba(255,255,255,0.75);
  --accent: #ff7a18;
  --accent2: #ffb347;
  --text: #1f2937;
  --ok: #16a34a;
  --pending: #f59e0b;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: Inter, system-ui, Arial, sans-serif;
  background: linear-gradient(120deg, #fff7ed, #ffe7d6);
  color: var(--text);
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 18px 28px;
}

h1 {
  margin: 0;
  font-size: 1.8rem;
}

button {
  border: none;
  padding: 8px 14px;
  border-radius: 10px;
  background: var(--accent);
  color: white;
  cursor: pointer;
  font-weight: 600;
}

.dashboard {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 22px;
  padding: 22px;
}

.card {
  background: var(--card);
  border-radius: 16px;
  padding: 18px;
  box-shadow: 0 12px 30px rgba(0,0,0,0.08);
}

.big-clock {
  text-align: center;
  font-size: 4.2rem;
  font-weight: 800;
}

.date {
  font-size: 1.1rem;
  opacity: 0.8;
}

.hg {
  font-size: 2rem;
  display: inline-block;
  transition: transform 0.8s ease;
}

.grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 18px;
}

.task {
  display: flex;
  justify-content: space-between;
  margin: 6px 0;
  padding: 6px 0;
  border-bottom: 1px dashed rgba(0,0,0,0.1);
}

.badge {
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 0.75rem;
  font-weight: 700;
  color: white;
}

.completed { background: var(--ok); }
.pending { background: var(--pending); }

.count {
  display: flex;
  justify-content: space-between;
  font-weight: 600;
  margin: 6px 0;
}

canvas {
  width: 100% !important;
  height: 260px !important;
}
</style>
</head>

<body>

<header>
  <h1>VCB StockTeam Dashboard</h1>
  <button onclick="toggleFull()">Fullscreen</button>
</header>

<div class="dashboard">

  <!-- LEFT -->
  <div>
    <div class="card">
      <div class="big-clock" id="clock"></div>
      <div class="date" id="date"></div>
      <div class="hg" id="hg">‚è≥</div>
    </div>

    <div class="grid-2" style="margin-top:18px;">
      <div class="card">
        <h3>Daily Tasks Completion</h3>
        <canvas id="dailyChart"></canvas>
      </div>
      <div class="card">
        <h3>Weekly Tasks Completion</h3>
        <canvas id="weeklyChart"></canvas>
      </div>
    </div>

    <div class="card" style="margin-top:18px;">
      <h3>Inventory by Area</h3>
      <canvas id="inventoryChart"></canvas>
    </div>

    <div class="card" style="margin-top:18px;">
      <h3>Weekly History</h3>
      <canvas id="historyChart"></canvas>
    </div>
  </div>

  <!-- RIGHT -->
  <div>
    <div class="card">
      <h3>Metadata</h3>
      <div class="count"><span>Target</span><span id="target"></span></div>
      <div class="count"><span>Timestamp</span><span id="timestamp"></span></div>
    </div>

    <div class="card" style="margin-top:18px;">
      <h3>Counts</h3>
      <div id="counts"></div>
    </div>

    <div class="card" style="margin-top:18px;">
      <h3>Daily Tasks</h3>
      <div id="dailyTasks"></div>
    </div>

    <div class="card" style="margin-top:18px;">
      <h3>Weekly Tasks</h3>
      <div id="weeklyTasks"></div>
    </div>
  </div>

</div>

<script>
function toggleFull(){
  if(!document.fullscreenElement) document.documentElement.requestFullscreen();
  else document.exitFullscreen();
}

/* CLOCK */
function updateClock(){
  const now = new Date();
  document.getElementById('clock').textContent =
    now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
  document.getElementById('date').textContent =
    now.toLocaleDateString();
  document.getElementById('hg').style.transform = 'rotate(360deg)';
}
setInterval(updateClock, 60000);
updateClock();

/* LOAD DATA */
async function loadData(){
  const res = await fetch('data/dashboard.json');
  const data = await res.json();

  document.getElementById('target').textContent = data.metadata.target;
  document.getElementById('timestamp').textContent = data.metadata.timestamp;

  /* COUNTS */
  const counts = document.getElementById('counts');
  data.counting.forEach(c=>{
    const d = document.createElement('div');
    d.className='count';
    d.innerHTML=`<span>${c.area}</span><span>${c.qty}</span>`;
    counts.appendChild(d);
  });

  /* TASKS */
  const renderTasks = (el, tasks)=>{
    el.innerHTML='';
    tasks.forEach(t=>{
      const s = t.status.toLowerCase().includes('completed')?'completed':'pending';
      const div=document.createElement('div');
      div.className='task';
      div.innerHTML=`<span>${t.name}</span>
      <span class="badge ${s}">${s}</span>`;
      el.appendChild(div);
    });
  };

  renderTasks(document.getElementById('dailyTasks'), data.dailyTasks);
  renderTasks(document.getElementById('weeklyTasks'), data.weeklyTasks);

  const countStatus = list => [
    list.filter(t=>t.status.toLowerCase().includes('completed')).length,
    list.filter(t=>!t.status.toLowerCase().includes('completed')).length
  ];

  /* CHARTS */
  new Chart(dailyChart, {
    type:'doughnut',
    data:{labels:['Completed','Pending'],
      datasets:[{data:countStatus(data.dailyTasks),
      backgroundColor:['#16a34a','#f59e0b']}]
    },
    options:{animation:{animateRotate:true}}
  });

  new Chart(weeklyChart, {
    type:'doughnut',
    data:{labels:['Completed','Pending'],
      datasets:[{data:countStatus(data.weeklyTasks),
      backgroundColor:['#16a34a','#f59e0b']}]
    }
  });

  new Chart(inventoryChart,{
    type:'bar',
    data:{
      labels:data.counting.map(c=>c.area),
      datasets:[{data:data.counting.map(c=>c.qty),
      backgroundColor:'#ff8a65'}]
    },
    options:{animation:{duration:1500}}
  });

  new Chart(historyChart,{
    type:'line',
    data:{
      labels:data.history.map(h=>h.week),
      datasets:[{
        data:data.history.map(h=>h.total),
        borderColor:'#ff7a18',
        tension:0.4,
        fill:false
      }]
    }
  });
}

loadData();
</script>

</body>
</html>
